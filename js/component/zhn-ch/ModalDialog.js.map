{"version":3,"file":"ModalDialog.js","names":["S_SHOW","display","S_HIDE","DialogButtons","buttons","refBtClose","withoutClose","onClose","CL_MD_ACTIONS","_useFocusBtClose","isShow","isFocusClose","_refBt","useRef","_refPrevFocused","_refIsShowPrev","focus","useCallback","current","document","activeElement","focusRefElement","focusPrev","useEffect","_isPrevShow","getRefValue","ModalDialog","className","style","isWithButton","caption","captionStyle","children","commandButtons","_refBtClose","_hClickDialog","event","stopPropagation","_hKeyDown","useKeyEscape","_className","crCn","CL_MODAL_DIALOG","CL_SHOWING","_style"],"sources":["../../../src/component/zhn-ch/ModalDialog.jsx"],"sourcesContent":["//import { PropTypes } from 'prop-types'\r\nimport {\r\n  useRef,\r\n  useCallback,\r\n  useEffect,\r\n  getRefValue,\r\n  focusRefElement\r\n} from '../uiApi';\r\n\r\nimport useKeyEscape from '../hooks/useKeyEscape';\r\nimport crCn from '../zhn-utils/crCn';\r\n\r\nimport DialogCaption from './DialogCaption';\r\nimport FlatButton from '../zhn-m/FlatButton';\r\n\r\nimport {\r\n  CL_MODAL_DIALOG,\r\n  CL_MD_ACTIONS,\r\n  CL_SHOWING\r\n} from '../style/CL';\r\n\r\nconst S_SHOW = { display: 'block' }\r\n, S_HIDE = { display: 'none' };\r\n\r\nconst DialogButtons = ({\r\n  buttons,\r\n  refBtClose,\r\n  withoutClose,\r\n  onClose\r\n}) => (\r\n  <div className={CL_MD_ACTIONS}>\r\n    {buttons}\r\n    { !withoutClose &&\r\n       <FlatButton\r\n         ref={refBtClose}\r\n         caption=\"Close\"\r\n         timeout={0}\r\n         onClick={onClose}\r\n       />\r\n    }\r\n  </div>\r\n);\r\n\r\nconst _useFocusBtClose = (\r\n  isShow,\r\n  isFocusClose\r\n) => {\r\n  const _refBt = useRef()\r\n  , _refPrevFocused = useRef()\r\n  , _refIsShowPrev = useRef()\r\n  , focus = useCallback(() => {\r\n      _refPrevFocused.current = document.activeElement\r\n      if (isFocusClose) {\r\n        focusRefElement(_refBt)\r\n      }\r\n  }, [isFocusClose])\r\n  , focusPrev = useCallback(()=>{\r\n      focusRefElement(_refPrevFocused)\r\n      _refPrevFocused.current = null\r\n  }, []);\r\n\r\n  useEffect(()=>{\r\n    const _isPrevShow = getRefValue(_refIsShowPrev);\r\n    if (isShow && !_isPrevShow) {\r\n      focus()\r\n    } else if (!isShow && _isPrevShow) {\r\n      focusPrev()\r\n    }\r\n    _refIsShowPrev.current = isShow\r\n  }, [isShow, focus, focusPrev])\r\n\r\n  return _refBt;\r\n};\r\n\r\nconst ModalDialog = ({\r\n  className='',\r\n  style,\r\n  isShow,\r\n  isWithButton=true,\r\n  isFocusClose=true,\r\n  caption,\r\n  captionStyle,\r\n  children,\r\n  commandButtons,\r\n  withoutClose,\r\n  onClose\r\n}) => {\r\n  const _refBtClose = _useFocusBtClose(\r\n     isShow,\r\n     isFocusClose\r\n   )\r\n  , _hClickDialog = useCallback(event => {\r\n    event.stopPropagation()\r\n  }, [])\r\n  , _hKeyDown = useKeyEscape(onClose)\r\n  , _className = crCn(`${CL_MODAL_DIALOG} ${className}`, [isShow, CL_SHOWING])\r\n  , _style = isShow ? S_SHOW : S_HIDE;\r\n\r\n\r\n  return (\r\n    /*eslint-disable jsx-a11y/no-noninteractive-element-interactions*/\r\n    <div\r\n       role=\"dialog\"\r\n       aria-label={caption}\r\n       aria-hidden={!isShow}\r\n       className={_className}\r\n       style={{...style, ..._style}}\r\n       onClick={_hClickDialog}\r\n       onKeyDown={_hKeyDown}\r\n    >\r\n   {/*eslint-disable jsx-a11y/no-noninteractive-element-interactions*/}\r\n       <DialogCaption\r\n          rootStyle={captionStyle}\r\n          caption={caption}\r\n          onClose={onClose}\r\n       />\r\n       <div>\r\n         {children}\r\n       </div>\r\n       { isWithButton && <DialogButtons\r\n           buttons={commandButtons}\r\n           refBtClose={_refBtClose}\r\n           withoutClose={withoutClose}\r\n           onClose={onClose}\r\n         /> }\r\n   </div>\r\n  );\r\n}\r\n\r\n/*\r\nModalDialog.propTypes = {\r\n  className: PropTypes.string,\r\n  style: PropTypes.object,\r\n  caption: PropTypes.string,\r\n  captionStyle: PropTypes.object,\r\n  isShow: PropTypes.bool,\r\n  isWithButton: PropTypes.bool,\r\n  withoutClose: PropTypes.bool,\r\n  isFocusClose: PropTypes.bool,\r\n  commandButtons: PropTypes.arrayOf(PropTypes.element),\r\n  onClose: PropTypes.func\r\n}\r\n*/\r\n\r\nexport default ModalDialog\r\n"],"mappings":"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"}