{"version":3,"file":"WrapperContainer.js","names":["DialogStack","TS","store","shows","data","dialogs","onClose","map","dialog","type","comp","createElement","key","isShow","dispatch","bind","WrapperContainer","memo","useTheme","styleConfig","_refModal","useRef","useState","currentDialog","inits","state","setState","_hClose","useCallback","prevState","useEffect","_onStore","modal","sApp","getState","id","dialogProps","_modal","getRefValue","setRefValue","push","Router","getDialog","subscribe"],"sources":["../../../src/component/zhn-cont/WrapperContainer.jsx"],"sourcesContent":["//import PropTypes from 'prop-types'\r\nimport {\r\n  createElement,\r\n  memo,\r\n  useRef,\r\n  useState,\r\n  useCallback,\r\n  useEffect,\r\n  getRefValue,\r\n  setRefValue\r\n} from '../uiApi';\r\n\r\nimport useTheme from '../hooks/useTheme';\r\nimport styleConfig from '../style/Dialog.Style';\r\n\r\nimport { sApp } from '../../flux/selectors';\r\n\r\nimport Router from '../dialogs/modalRouter';\r\nimport WrapperModalDialog from '../zhn-ch/WrapperModalDialog';\r\n\r\nconst DialogStack = ({\r\n  TS,\r\n  store,\r\n  shows,\r\n  data,\r\n  dialogs,\r\n  onClose\r\n}) => dialogs.map(dialog => {\r\n  const { type, comp } = dialog;\r\n  return createElement(comp, {\r\n    TS,\r\n    key: type,\r\n    isShow: shows[type],\r\n    data: data[type],\r\n    store: store,\r\n    dispatch: store.dispatch,\r\n    onClose: onClose.bind(null, type)\r\n  });\r\n});\r\n\r\nconst WrapperContainer = memo(({\r\n  store\r\n}) => {\r\n  const TS = useTheme(styleConfig)\r\n  , _refModal = useRef()\r\n  , [\r\n    state,\r\n    setState\r\n  ] = useState({\r\n     isShow: false,\r\n     currentDialog: null,\r\n     dialogs: [],\r\n     inits: {},\r\n     shows: {},\r\n     data: {}\r\n  })\r\n  , _hClose = useCallback(type => {\r\n    setState(prevState => {\r\n      prevState.shows[type] = false\r\n      return {\r\n        ...prevState,\r\n        isShow: false,\r\n        currentDialog: null,\r\n        shows: prevState.shows\r\n      };\r\n    })\r\n  }, [])\r\n\r\n  /*eslint-disable react-hooks/exhaustive-deps */\r\n  useEffect(() => {\r\n    const _onStore = () => {\r\n      const modal = sApp.modal(store.getState())\r\n      , {\r\n        id:type,\r\n        data:dialogProps={}\r\n      } = modal\r\n      , _modal = getRefValue(_refModal);\r\n      if (type && _modal !== modal) {\r\n        setRefValue(_refModal, modal)\r\n        setState(prevState => {\r\n          const {\r\n            inits,\r\n            shows,\r\n            data,\r\n            dialogs\r\n          } = prevState;\r\n          if (!inits[type]){\r\n            dialogs.push({\r\n              type,\r\n              comp: Router.getDialog(type)\r\n            })\r\n            inits[type] = true\r\n          }\r\n          shows[type] = true\r\n          data[type] = dialogProps\r\n          return {\r\n            isShow: true,\r\n            currentDialog: type,\r\n            shows,\r\n            data,\r\n            dialogs,\r\n            inits\r\n          };\r\n        })\r\n      }\r\n    }\r\n    return store.subscribe(_onStore);\r\n  }, [])\r\n  // store\r\n  /*eslint-disable react-hooks/exhaustive-deps */\r\n\r\n  const {\r\n    isShow,\r\n    currentDialog,\r\n    shows,\r\n    data,\r\n    dialogs\r\n  } = state;\r\n\r\n  return (\r\n    <WrapperModalDialog\r\n      isShow={isShow}\r\n      onClose={_hClose.bind(null, currentDialog)}\r\n    >\r\n      <DialogStack\r\n        TS={TS}\r\n        store={store}\r\n        shows={shows}\r\n        data={data}\r\n        dialogs={dialogs}\r\n        onClose={_hClose}\r\n      />\r\n   </WrapperModalDialog>\r\n  );\r\n})\r\n\r\n/*\r\nWrapperContainer.propTypes = {\r\n  store: PropTypes.shape({\r\n    subscribe: PropTypes.func\r\n  })\r\n}\r\n*/\r\n\r\nexport default WrapperContainer\r\n"],"mappings":"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"}