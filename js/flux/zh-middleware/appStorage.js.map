{"version":3,"file":"appStorage.js","names":["appStorage","getState","dispatch","next","action","type","saveBoard","window","localStorage","setItem","CONF","STORAGE_KEY","JSON","stringify","drawerMsg","modal","id","data","addDrawerMsg","msg","MSG_SAVED","e","MSG_SAVE_FAIL","console","log","cleanStorage","removeItem","MSG_CLEANED","MSG_CLEAN_FAIL"],"sources":["../../../src/flux/zh-middleware/appStorage.js"],"sourcesContent":["import { saveBoard, cleanStorage } from '../app/actions'\r\nimport { addDrawerMsg } from '../drawerMsg/reducer'\r\nimport CONF from '../appConf'\r\n\r\nconst appStorage = ({ getState, dispatch }) => next => action => {\r\n  switch(action.type){\r\n    case saveBoard.type: {\r\n      try {\r\n        window.localStorage.setItem(\r\n          CONF.STORAGE_KEY,\r\n          JSON.stringify({\r\n            ...getState(),\r\n            drawerMsg: [],\r\n            modal: { id: null, data: null }\r\n          })\r\n        )\r\n        dispatch(\r\n          addDrawerMsg({ msg: CONF.MSG_SAVED })\r\n        )\r\n        return true;\r\n      } catch(e) {\r\n        dispatch(\r\n          addDrawerMsg({ msg: CONF.MSG_SAVE_FAIL })\r\n        )\r\n        console.log(e.msg)\r\n        return false;\r\n      }\r\n    }\r\n    case cleanStorage.type: {\r\n      try {\r\n        window.localStorage.removeItem(CONF.STORAGE_KEY)\r\n        dispatch(\r\n          addDrawerMsg({ msg: CONF.MSG_CLEANED })\r\n        )\r\n        return true;\r\n      } catch(e){\r\n        dispatch(\r\n          addDrawerMsg({ msg: CONF.MSG_CLEAN_FAIL })\r\n        )\r\n        console.log(e.msg)\r\n        return false;\r\n      }\r\n    }\r\n    default: return next(action);\r\n  }\r\n};\r\n\r\nexport default appStorage\r\n"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;AAEA,IAAMA,UAAU,GAAG,SAAbA,UAAa;EAAA,IAAGC,QAAH,QAAGA,QAAH;EAAA,IAAaC,QAAb,QAAaA,QAAb;EAAA,OAA4B,UAAAC,IAAI;IAAA,OAAI,UAAAC,MAAM,EAAI;MAC/D,QAAOA,MAAM,CAACC,IAAd;QACE,KAAKC,kBAAA,CAAUD,IAAf;UAAqB;YACnB,IAAI;cACFE,MAAM,CAACC,YAAP,CAAoBC,OAApB,CACEC,mBAAA,CAAKC,WADP,EAEEC,IAAI,CAACC,SAAL,+BACKZ,QAAQ,EADb;gBAEEa,SAAS,EAAE,EAFb;gBAGEC,KAAK,EAAE;kBAAEC,EAAE,EAAE,IAAN;kBAAYC,IAAI,EAAE;gBAAlB;cAHT,GAFF;cAQAf,QAAQ,CACN,IAAAgB,qBAAA,EAAa;gBAAEC,GAAG,EAAET,mBAAA,CAAKU;cAAZ,CAAb,CADM,CAAR;cAGA,OAAO,IAAP;YACD,CAbD,CAaE,OAAMC,CAAN,EAAS;cACTnB,QAAQ,CACN,IAAAgB,qBAAA,EAAa;gBAAEC,GAAG,EAAET,mBAAA,CAAKY;cAAZ,CAAb,CADM,CAAR;cAGAC,OAAO,CAACC,GAAR,CAAYH,CAAC,CAACF,GAAd;cACA,OAAO,KAAP;YACD;UACF;;QACD,KAAKM,qBAAA,CAAapB,IAAlB;UAAwB;YACtB,IAAI;cACFE,MAAM,CAACC,YAAP,CAAoBkB,UAApB,CAA+BhB,mBAAA,CAAKC,WAApC;cACAT,QAAQ,CACN,IAAAgB,qBAAA,EAAa;gBAAEC,GAAG,EAAET,mBAAA,CAAKiB;cAAZ,CAAb,CADM,CAAR;cAGA,OAAO,IAAP;YACD,CAND,CAME,OAAMN,CAAN,EAAQ;cACRnB,QAAQ,CACN,IAAAgB,qBAAA,EAAa;gBAAEC,GAAG,EAAET,mBAAA,CAAKkB;cAAZ,CAAb,CADM,CAAR;cAGAL,OAAO,CAACC,GAAR,CAAYH,CAAC,CAACF,GAAd;cACA,OAAO,KAAP;YACD;UACF;;QACD;UAAS,OAAOhB,IAAI,CAACC,MAAD,CAAX;MAtCX;IAwCD,CAzCkD;EAAA,CAAhC;AAAA,CAAnB;;eA2CeJ,U"}